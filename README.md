# venus-sample-validating-source

Venus Fugerit Doc sample showing how to validate source documents

[![Keep a Changelog v1.1.0 badge](https://img.shields.io/badge/changelog-Keep%20a%20Changelog%20v1.1.0-%23E05735)](CHANGELOG.md)
[![Quality Gate Status](https://sonarcloud.io/api/project_badges/measure?project=fugerit79_venus-sample-validating-source&metric=alert_status)](https://sonarcloud.io/summary/new_code?id=fugerit79_venus-sample-validating-source)
[![Coverage](https://sonarcloud.io/api/project_badges/measure?project=fugerit79_venus-sample-validating-source&metric=coverage)](https://sonarcloud.io/summary/new_code?id=fugerit79_venus-sample-validating-source)
[![License: MIT](https://img.shields.io/badge/License-MIT-teal.svg)](https://opensource.org/licenses/MIT)
[![code of conduct](https://img.shields.io/badge/conduct-Contributor%20Covenant-purple.svg)](https://github.com/fugerit-org/fj-universe/blob/main/CODE_OF_CONDUCT.md)

This project is part of a series of mini tutorial on [Venus Fugerit Doc](https://github.com/fugerit-org/fj-doc),
here you can find the [other tutorials](https://github.com/fugerit79/venus-sample-index).

## Requirement

* JDK 8+ (*)
* Maven 3.8+

## Quickstart

This is a sample project configured using [fj-doc-maven-plugin init plugin](https://venusdocs.fugerit.org/guide/#maven-plugin-goal-init).

flavour : vanilla

Creation command : 

```shell
mvn org.fugerit.java:fj-doc-maven-plugin:8.16.5:init \
-DgroupId=org.fugerit.java.demo \
-DartifactId=venus-sample-validating-source \
-Dextensions=base,freemarker \
-Dflavour=vanilla
```

## Adding source document validation

When writing a [Venus Fugerit Doc source document](https://venusdocs.fugerit.org/guide/#doc-format-entry-point-xml) :

```xml
<row><para>This element is not allowed this</para>
    <cell><para>Luthien</para></cell>
    <cell><para>Tinuviel</para></cell>
    <cell><para>Queen</para></cell>
</row>
```

It is possible to validate the XML source document by [adding validating and/or failOnValidate properties](src/main/resources/venus-sample-validating-source/fm-doc-process-config.xml) to
[freemarker-doc-process-config](https://venusdocs.fugerit.org/guide/#doc-freemarker-config-attributes) : 

```xml
<freemarker-doc-process-config
        xmlns="https://freemarkerdocprocess.fugerit.org"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="https://freemarkerdocprocess.fugerit.org https://www.fugerit.org/data/java/doc/xsd/freemarker-doc-process-1-0.xsd"
        validating="true"
        failOnValidate="true">
```

This will print validation information (and eventually fail if *failOnValidate* is set to *true*) : 

```text
[main] WARN org.fugerit.java.doc.freemarker.process.DocInputProcess - DocValidationResult failed!, errors : 2
[main] WARN org.fugerit.java.doc.freemarker.process.DocInputProcess - Validation error 0, org.xml.sax.SAXParseException; lineNumber: 39; columnNumber: 28; cvc-complex-type.2.4.a: Invalid content was found starting with element '{"http://javacoredoc.fugerit.org":para}'. One of '{"http://javacoredoc.fugerit.org":cell}' is expected.
[main] WARN org.fugerit.java.doc.freemarker.process.DocInputProcess - Validation error 1, org.xml.sax.SAXParseException; lineNumber: 44; columnNumber: 28; cvc-complex-type.2.4.a: Invalid content was found starting with element '{"http://javacoredoc.fugerit.org":para}'. One of '{"http://javacoredoc.fugerit.org":cell}' is expected.
```

Here are the resources we modified for this example : 

* the Venus Fugerit Doc configuration [fm-doc-process-config.xml](src/main/resources/venus-sample-validating-source/fm-doc-process-config.xml)
* [dynamic data](https://venusdocs.fugerit.org/guide/#doc-freemarker-entry-point) generated by a freemarker template [document.ftl](src/main/resources/venus-sample-validating-source/template/document.ftl)
* the JUnit putting all together [DocHelperTest.java](src/test/java/test/org/fugerit/java/demo/venussamplevalidatingsource/DocHelperTest.java)

NOTE: the printed errors are related to the XML source after FreeMarker template processing.
